{%load static%}
<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-173563544-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-173563544-1');
</script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Relevant and Irreverent | Welcome</title>
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
  <link rel="stylesheet" href="{% static './css/style.css' %}">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <style>
    /*Crossword*/
.crossword-instructions{
  margin: 1rem 5rem 2rem 5rem;
}
.crossword-instructions h3{
  color: #f6660c;
  font-weight:700;
}
.crossword-instructions .instruction-list{
  font-size:1rem;
  border: 1px solid rgb(5, 159, 206);
  border-radius: 10px;
}
.crossword-container{
  display:flex;
  flex-direction: row;
  justify-content: center;
  margin:3rem 2rem 200px 2rem;
  
}
.crossword-grid{
  display: inline-flex; 
  flex-direction:column; 
  flex-wrap:wrap; 
  
}

.empty-cell{
  width:28px;
  height:28px;
  background:rgb(68, 68, 68);
}
.input-boxes{
  width:28px;
  height:28px; 
  font-size:1rem;
  font-weight: 800;
  text-align: center;
  text-transform: capitalize;
  
}
.crossword-form{
  
  margin-left: auto;
  margin-right:13rem;
}
.clue-box{
  display:flex;
  flex-direction: row;
  margin-left:13rem;
  margin-right:auto;
  

}  

.clue-list {
  
  display:flex;
  flex-direction:column;
  align-content:center;
  justify-content:top;
  font-size: 1;
  font-weight: 500;
  padding: 0px 5px 0px 5px;
  width:100%;
}
.clue-list .list-title {
  font-size:1.1rem;
  font-weight: 900;
  padding-bottom: 5px;
}
.clue-list .start-position {
  color: #3f0cf6;
  font-size: 1rem;
  font-weight: 700;
  padding: 0px 5px 0px 0px;
  
}
.input-wrapper{
  position:relative;
  float:left;
  width:28px;
  height:28px;
}

.input-wrapper .unit{
  position:absolute;
  top:2px;
  left:2px;
  font-size:0.6rem;
}
  </style>
</head>
<body>
  <header class='top-header'>
    <div class="navbar">
      <div class="navlogo">
        <img src="{% static './images/R&I-logo.png' %}" alt="logo">
      </div>
   <div class="subscribe-link-wrapper">
    <div class="subs-top">
      <!-- <div class="messages-top" id="message-top">{% if messages %}
        <ul>
            {% for message in messages %}
            <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
            {% endfor %}
        </ul>
        {% endif %}
      </div> -->
      <div><button  class="sub-btn" id ="sub-btn"  name="check-result" value="check-result">Subscribe</button></div>
      
      <div class="input-form-wrapper" id="input-form" style="margin-bottom:35px;">
      <form action="{% url 'subscribe' %}" method="POST" class="sub-input-form" id="input-form">
          {% csrf_token %}
       <div> <input type="email" id="email-field" style="display:none;" name="email" placeholder="Enter your email address" required></div>  
       <div> <button type="submit" class="sub-btn" id ="final-sub-btn" style="display:none;" name="subscribe" value="subscribe">Subscribe</button></div>
      </form>
    </div>
    
    </div>
    
        <nav class="nav-items">
          <ul>
              <li><a href="{% url 'index'%}">Home</a></li>
            <li><a href="{% url 'latestnews' %}">Latest</a></li>
            <li><a href="{% url 'archives'%}">Archives</a></li>
            <li><a href="{% url 'storytitle'%}">Contests</a></li>
            <li><a href="{% url 'contactus' %}">Contact</a></li>
          </ul>
        </nav>
      </div>
      </div>
  </header>
      <section>
          <div class="crossword-instructions"><h3>Instructions</h3>
            <ol class="intruction-list">
              <li>Lorem Ipsum has been the industry's standard dummy text ever since the 1500s</li>
              <li>It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout.</li>
              <li>There are many variations of passages of Lorem Ipsum available, but the majority have suffered alteration in some form, by injected humour, or randomised words which don't look even slightly believable. </li>
              <li>Contrary to popular belief, Lorem Ipsum is not simply random text. It has roots in a piece of classical Latin literature from 45 BC, making it over 2000 years old.</li>
            </ol>
          </div>
          <div class = "crossword-container" id="main-box">
            <div class="crossword-form">
          <form action="{% url 'crossword_check' %}" method="POST" >
              {% csrf_token %}
          <div class="crossword-grid" style="max-height:412.5px">
              {%for item in all_cells%} 
              {%if item in empty_cells%}
              <p class="empty-cell" id ="cell{{item.0}},{{item.1}}" name = "cell{{item.0}},{{item.1}}" style="border:0.5px solid black;background:#fc802d;width:27.5px;height:27.5px;margin-top:0px !important;"></p>
              {%else%}
              <div class="input-wrapper" style="width:27.5px;height:27.5px">
              <p  class="input-boxes" id ="cell{{item.0}},{{item.1}}" name = "cell{{item.0}},{{item.1}}" maxlength="1" style="width:27.5px;height:27.5px;border:none;border-radius:0px;background:white;border:0.5px solid black;box-sizing:border-box;margin-top:0px !important; color:black;"></p>
              {%for word in all_word_list%}
              {%if word.3 == item.0 and word.4 == item.1 %}
              <div class="unit">{{word.2}}</div>
              {% endif %}
              {%endfor%}

            </div>
              {% endif %}
              {%endfor%}

          </div>
          <div class="game-submit" id="game-submit">
          <div><input type="text" id="name" name="name" placeholder="Enter your name" required></div>  
          <div><input type="email" id="email" name="email" placeholder="Enter your email address" required></div>  
          <input type="checkbox" id="subscribe" name="subscribe" value="subcribe" checked>
          <label for="subscribe">Please subscribe for the newsletter</label>
          <div><button type="submit" class="submit-btn" id ="submit-btn"  name="check-result" value="check-result">Submit</button></div>
        </div>
        </form>
        <div><button  class="done-btn" id ="done-btn"  name="check-result" value="check-result">Submit</button></div>
        
      </div>
        <div class = "clue-box">
            <div class="clue-list">
                <p class="list-title">Across</p>
                {%for item in word_across_list%}
                <div><span class="start-position">{{item.2}}</span> {{item.5}}</div>
                {%endfor%}
            </div>
            <div class="clue-list">
                <p class="list-title">Down</p>
                {%for item in word_down_list%}
                <div><span class="start-position">{{item.2}}</span> {{item.5}}</div>
                {%endfor%}
            </div>
            
            </div>
        </div>
 <script type="text/javascript">



var x = document.getElementsByClassName("input-boxes");
var y = document.getElementsByClassName("empty-cell");

   
    
var u = document.getElementById("done-btn");
    u.addEventListener("click",k);
    
    
  document.addEventListener("keypress",g, false);
  document.addEventListener("keydown",h, false);
  document.addEventListener("keyup",l, false);
  
  
  for (i = 0; i <= {{max_x_coordinate}}; i++) {
  for (j = 0; j <= {{max_y_coordinate}}; j++) {
    if(x.namedItem(`cell${i},${j}`) != null){
      x.namedItem(`cell${i},${j}`).addEventListener('click',f);
    }
  }
}
  
w = [];
function f(e){
  var z = e.target;
  w.push(z);
  console.log(w);
  z.style.background = "#b8b8b8";
  // if (w.length==1){
  //   w[w.length-1].style.background = "#b8b8b8";
  // }
  if ((w.length) > 1){
  if (w[w.length-2].textContent == ""){
    w[w.length-2].style.background = "white";
    // w[w.length-1].style.background = "#b8b8b8";
  } else{
    // w[w.length-1].style.background = "d6fdff";
    w[w.length-2].style.background = "#d6fdff";
  }
  }
  }

function g(e){
    w[w.length-1].textContent = e.key;
  }
function k(e){
    v.style.display = "none";
    n.style.display = "";
}



function l(e){
    if (e.keyCode == 8) {
      i = w[w.length-1].getAttribute("name").substring(4).split(',')[0];
      j = w[w.length-1].getAttribute("name").substring(4).split(',')[1];
      
      if(x.namedItem(`cell${i},${j}`) != null){
        x.namedItem(`cell${i},${j}`).textContent ="";
    }
  }
  }
function h(e) {

  if([32, 37, 38, 39, 40].indexOf(e.keyCode) > -1) {
        e.preventDefault();
    }

  if (e.keyCode == 37) {
    i = w[w.length-1].getAttribute("name").substring(4).split(',')[0];
     j = w[w.length-1].getAttribute("name").substring(4).split(',')[1];
     if(x.namedItem(`cell${i-1},${j}`) != null){
        x.namedItem(`cell${i-1},${j}`).focus();
        x.namedItem(`cell${i-1},${j}`).style.background = "#b8b8b8";
        w.push(x.namedItem(`cell${i-1},${j}`));
        if (x.namedItem(`cell${i},${j}`).textContent==""){
        x.namedItem(`cell${i},${j}`).style.background ="white";
        } else{
        x.namedItem(`cell${i},${j}`).style.background ="#d6fdff";
        
  }

    }
  } 

     if (e.keyCode == 39) {
      i = w[w.length-1].getAttribute("name").substring(4).split(',')[0];
      j = w[w.length-1].getAttribute("name").substring(4).split(',')[1];
      
      if(x.namedItem(`cell${parseInt(i)+1},${j}`) != null){
        x.namedItem(`cell${parseInt(i)+1},${j}`).focus();
        x.namedItem(`cell${parseInt(i)+1},${j}`).style.background = "#b8b8b8";
        w.push(x.namedItem(`cell${parseInt(i)+1},${j}`));
        if (x.namedItem(`cell${i},${j}`).textContent==""){
        x.namedItem(`cell${i},${j}`).style.background ="white";
        } else{
        x.namedItem(`cell${i},${j}`).style.background ="#d6fdff";
        
      }
    }
     }

      if (e.keyCode == 38) {
      i = w[w.length-1].getAttribute("name").substring(4).split(',')[0];
      j = w[w.length-1].getAttribute("name").substring(4).split(',')[1];
      
      if(x.namedItem(`cell${i},${j-1}`) != null){
        x.namedItem(`cell${i},${j-1}`).focus();
        x.namedItem(`cell${i},${j-1}`).style.background = "#b8b8b8";
        w.push(x.namedItem(`cell${i},${j-1}`));
        if (x.namedItem(`cell${i},${j}`).textContent==""){
        x.namedItem(`cell${i},${j}`).style.background ="white";
        } else{
        x.namedItem(`cell${i},${j}`).style.background ="#d6fdff";
        
        }
        }
      }

      if (e.keyCode == 40) {
      i = w[w.length-1].getAttribute("name").substring(4).split(',')[0];
      j = w[w.length-1].getAttribute("name").substring(4).split(',')[1];
      
      if(x.namedItem(`cell${i},${parseInt(j)+1}`) != null){
        x.namedItem(`cell${i},${parseInt(j)+1}`).focus();
        x.namedItem(`cell${i},${parseInt(j)+1}`).style.background = "#b8b8b8";
        w.push(x.namedItem(`cell${i},${parseInt(j)+1}`));
        if (x.namedItem(`cell${i},${j}`).textContent==""){
        x.namedItem(`cell${i},${j}`).style.background ="white";
        } else{
        x.namedItem(`cell${i},${j}`).style.background ="#d6fdff";
        
        }
        
      }
      
      }
     }
    resultString="";
    function k(e) {
    for (i = 0; i <= {{max_x_coordinate}}; i++) {
    for (j = 0; j <= {{max_y_coordinate}}; j++) {
    if(x.namedItem(`cell${i},${j}`) != null){
      resultString += x.namedItem(`cell${i},${j}`).textContent;
      console.log(resultString);
    }
  }
}
    }
console.log(resultString);
      </script>
      <script>
        $(document).ready(function(){
          $("#done-btn").click(function(){
            console.log("Hello 1");
            $.post("{% url 'crossword_check' %}",
            {
              
              city: resultString,
              csrfmiddlewaretoken : "{{csrf_token}}"
            },
            function(data,status){
              console.log("Hello 1");
              alert("Data: " + data + "\nStatus: " + status);
            });
          });
        });
        </script>
      </section>
        
      <footer id="main-footer">
          <div class="footer-container">
         
           
              
            <div class="navlinks">
              <ul class="linklist">
                  <li><a href="{% url 'index'%}">Home</a></li>
                  <li><a href="{% url 'latestnews' %}">Latest</a></li>
                  <li><a href="{% url 'archives'%}">Archives</a></li>
                  <li><a href="{% url 'storytitle'%}">Contests</a></li>
                  <li><a href="{% url 'contactus' %}">Contact</a></li>
              </ul>
            </div>
  
            
            <div class="icons">
            <p>Follow us on</p>
            <a target="_blank"  href="https://www.facebook.com/RnIsays"><i class="fab fa-facebook fa-2x sicons"></i></a>
            <a target="_blank" href="http://twitter.com/RnIsays" target="_blank"><i class="fab fa-twitter fa-2x 
                sicons"></i></a>
            <a target="_blank"  href="http://instagram.com/relevant.irreverent" target="_blank"><i class="fab fa-instagram fa-2x sicons"></i></a> 
          </div>
          
          </div>
        </footer>
</body>
</html>